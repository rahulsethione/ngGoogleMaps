angular.module("SimpleGoogleMaps",[]),function(o){o.directive("simpleGoogleMap",function(){return{restrict:"E",replace:!0,template:"<div></div>",scope:{options:"=",markers:"=",route:"=",info:"=",resize:"="},link:function(o,n,e){function t(o,n,e){return n.center=new google.maps.LatLng(n.center.lat,n.center.lng),n.zoomControl=!0,n.zoomControlOptions={position:google.maps.ControlPosition.TOP_RIGHT},e(new google.maps.Map(document.getElementById(o),n))}function i(o){return new google.maps.Marker({position:o.position,title:o.title,animation:google.maps.Animation.DROP,icon:o.icon?o.icon:e.markerIcon?e.markerIcon:""})}function l(n){w.map(function(o){a(o)}),w=[],d=new google.maps.LatLngBounds,n.map(function(o){var n=i(o);o.click&&"function"==typeof o.click&&c(n,o.click),o.mouseover&&"function"==typeof o.mouseover&&s(n,o.mouseover),d.extend(n.position),w.push(n)}),window.setTimeout(function(){w.map(function(n){o.$apply(function(){n.setMap(p)})})},1e3),w.length>0&&(1==w.length?(p.setCenter(w[0].position),p.setZoom(10)):p.fitBounds(d))}function a(o){o.setMap(null)}function c(o,n){o.addListener("click",n)}function s(o,n){o.addListener("mouseover",n)}function r(o){o&&o.length>=2?m.route({origin:new google.maps.LatLng(o[0].lat,o[0].lng),destination:new google.maps.LatLng(o[o.length-1].lat,o[o.length-1].lng),waypoints:v,optimizeWaypoints:!0,travelMode:google.maps.TravelMode.DRIVING},function(o,n){n===google.maps.DirectionsStatus.OK&&(f.setMap(p),f.setDirections(o))}):f.setMap(null)}function u(o){window.setTimeout(function(){return google.maps.event.trigger(p,"resize"),o()},100)}function g(o){p.setCenter(o)}var p,m,f,d,w=[],v=[],k=null;o.$watchCollection("route",function(o,n){r(o)}),o.$watchCollection("markers",function(o,n){l(o)}),o.$watchCollection("resize",function(o,n){o&&u(function(){g(p.getCenter())})}),o.$watchCollection("info",function(o,n){o&&(k&&k.close(),k=new google.maps.InfoWindow(o),o.index?k.open(p,w[o.index]):k.open(p,w[0]))}),t(e.id,o.options,function(n){p=n,l(o.markers),m=new google.maps.DirectionsService,f=new google.maps.DirectionsRenderer})}}})}(angular.module("SimpleGoogleMaps"));