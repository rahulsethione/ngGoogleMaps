angular.module("ngGoogleMaps",[]),function(n){n.directive("ngGoogleMap",function(){return{restrict:"E",replace:!0,template:"<div></div>",scope:{options:"=",markers:"=",route:"=",info:"=",resize:"="},link:function(n,o,e){function t(n,o,e){return o.center=new google.maps.LatLng(o.center.lat,o.center.lng),o.zoomControl=!0,o.zoomControlOptions={position:google.maps.ControlPosition.TOP_RIGHT},e(new google.maps.Map(document.getElementById(n),o))}function i(n){return new google.maps.Marker({position:n.position,title:n.title,animation:google.maps.Animation.DROP,icon:n.icon?n.icon:e.markerIcon?e.markerIcon:""})}function l(o){w.map(function(n){a(n)}),w=[],d=new google.maps.LatLngBounds,o.map(function(n){var o=i(n);n.click&&"function"==typeof n.click&&c(o,n.click),n.mouseover&&"function"==typeof n.mouseover&&r(o,n.mouseover),d.extend(o.position),w.push(o)}),window.setTimeout(function(){w.map(function(o){n.$apply(function(){o.setMap(p)})})},1e3),w.length>0&&(1==w.length?(p.setCenter(w[0].position),p.setZoom(10)):p.fitBounds(d))}function a(n){n.setMap(null)}function c(n,o){n.addListener("click",o)}function r(n,o){n.addListener("mouseover",o)}function s(n){n&&n.length>=2?m.route({origin:new google.maps.LatLng(n[0].lat,n[0].lng),destination:new google.maps.LatLng(n[n.length-1].lat,n[n.length-1].lng),waypoints:v,optimizeWaypoints:!0,travelMode:google.maps.TravelMode.DRIVING},function(n,o){o===google.maps.DirectionsStatus.OK&&(f.setMap(p),f.setDirections(n))}):f.setMap(null)}function g(n){window.setTimeout(function(){return google.maps.event.trigger(p,"resize"),n()},100)}function u(n){p.setCenter(n)}var p,m,f,d,w=[],v=[],k=null;n.$watchCollection("route",function(n,o){s(n)}),n.$watchCollection("markers",function(n,o){l(n)}),n.$watchCollection("resize",function(n,o){n&&g(function(){u(p.getCenter())})}),n.$watchCollection("info",function(n,o){n&&(k&&k.close(),k=new google.maps.InfoWindow(n),n.index?k.open(p,w[n.index]):k.open(p,w[0]))}),t(e.id,n.options,function(o){p=o,l(n.markers),m=new google.maps.DirectionsService,f=new google.maps.DirectionsRenderer})}}})}(angular.module("ngGoogleMaps"));